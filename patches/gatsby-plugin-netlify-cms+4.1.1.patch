diff --git a/node_modules/gatsby-plugin-netlify-cms/.npmignore b/node_modules/gatsby-plugin-netlify-cms/.npmignore
new file mode 100644
index 0000000..e771d2c
--- /dev/null
+++ b/node_modules/gatsby-plugin-netlify-cms/.npmignore
@@ -0,0 +1,34 @@
+# Logs
+logs
+*.log
+
+# Runtime data
+pids
+*.pid
+*.seed
+
+# Directory for instrumented libs generated by jscoverage/JSCover
+lib-cov
+
+# Coverage directory used by tools like istanbul
+coverage
+
+# Grunt intermediate storage (http://gruntjs.com/creating-plugins#storing-task-files)
+.grunt
+
+# node-waf configuration
+.lock-wscript
+
+# Compiled binary addons (http://nodejs.org/api/addons.html)
+build/Release
+
+# Dependency directory
+# https://www.npmjs.org/doc/misc/npm-faq.html#should-i-check-my-node_modules-folder-into-git
+node_modules
+*.un~
+yarn.lock
+src
+flow-typed
+coverage
+decls
+examples
diff --git a/node_modules/gatsby-plugin-netlify-cms/gatsby-node.js b/node_modules/gatsby-plugin-netlify-cms/gatsby-node.js
index c5eaed1..358ea0b 100644
--- a/node_modules/gatsby-plugin-netlify-cms/gatsby-node.js
+++ b/node_modules/gatsby-plugin-netlify-cms/gatsby-node.js
@@ -50,13 +50,11 @@ function replaceRule(value) {
   // If `value` does not have a `test` property, it isn't a rule object.
   if (!value || !value.test) {
     return value;
-  } // when javascript we exclude node_modules
+  } // remove dependency rule
 
 
-  if (value.type === "javascript/auto" && value.exclude && value.exclude instanceof RegExp) {
-    return (0, _extends2.default)({}, value, {
-      exclude: new RegExp([value.exclude.source, "node_modules|bower_components"].join("|"))
-    });
+  if (value.type === "javascript/auto" && value.use && value.use[0] && value.use[0].options && value.use[0].options.presets && /babel-preset-gatsby[/\\]dependencies\.js/.test(value.use[0].options.presets)) {
+    return null;
   } // Manually swap `style-loader` for `MiniCssExtractPlugin.loader`.
   // `style-loader` is only used in development, and doesn't allow us to pass
   // the `styles` entry css path to Netlify CMS.
@@ -127,7 +125,7 @@ exports.onCreateWebpackConfig = function (_ref3, _ref4) {
       path: _path.default.join(program.directory, "public", publicPathClean)
     },
     module: {
-      rules: deepMap(gatsbyConfig.module.rules, replaceRule)
+      rules: deepMap(gatsbyConfig.module.rules, replaceRule).filter(Boolean)
     },
     plugins: gatsbyConfig.plugins.filter(function (plugin) {
       return !["MiniCssExtractPlugin", "GatsbyWebpackStatsExtractor"].find(function (pluginName) {
